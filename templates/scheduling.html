<!doctype html>
<html>
    <title>Scheduling solver</title>
<head>
<style>
.errors { color: red; }
dt { font-weight: bold; margin-top: 1em }
dl, dd { font-size: .9rem; }
pre { border: solid 1px; padding: 1em; }
</style>
</head>

<body>

<h1>Generate a Faculty Schedule Solution</h1>

<h2>Instructions</h2>

<p>Upload a formatted XLSX file.</p>
<p><a href="">Example template file</a></p>

<hr>

{% macro render_field(field) %}
  <div>{{ field.label }}: {{ field(**kwargs)|safe }} {% if field.errors %} <span class=errors> {% for error in field.errors %} {{ error }} {% endfor %} </span> {% endif %}
  </div>
{% endmacro %}


<br>
<form method="POST" action="" enctype="multipart/form-data">
    {{ render_field(form.xlsxfile, onchange="this.form.submit()") }}
    {{ form.csrf_token() }}
    {{ form.submit }}
    <!--<p><input type=submit value=Submit>-->
</form>
<br>

<hr>

{% if output %}
Results from <b>{{ filename }}</b> generated on {{ timestamp }}:

<br>

<dl>
{% for prof, d in result.items() %}
    <dt>{{ prof }} {{ "(%.0f / %d)"|format(d['TLC'], d['capacity']) }}</dt>
    {% for course in d['courses'] %}
        <dd>{{ course }}</dd>
    {% endfor %}
{% endfor %}
</dl>

<br>

<pre>
{{ output }}
</pre>
{% else %}
<div style='color: grey'>
(Results will display here after uploading.)
</div>
{% endif %}

</body>
</html>
